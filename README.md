# ZOE Outage API - –ì—Ä–∞—Ñ—ñ–∫–∏ –≤—ñ–¥–∫–ª—é—á–µ–Ω—å –µ–ª–µ–∫—Ç—Ä–æ–µ–Ω–µ—Ä–≥—ñ—ó

REST API –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –≥—Ä–∞—Ñ—ñ–∫—ñ–≤ –≤—ñ–¥–∫–ª—é—á–µ–Ω—å –µ–ª–µ–∫—Ç—Ä–æ–µ–Ω–µ—Ä–≥—ñ—ó –∑ —Å–∞–π—Ç—É [zoe.com.ua](https://www.zoe.com.ua/outage/)

## –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

### 1. –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 2. –ó–∞–ø—É—Å–∫ API —Å–µ—Ä–≤–µ—Ä–∞

```bash
python main.py
```

–∞–±–æ

```bash
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

### 3. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—é API

–ü–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ [http://localhost:8000/docs](http://localhost:8000/docs)

## –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

```bash
# –ó–±—ñ–ª–¥–∏—Ç–∏ —Ç–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–∏
docker-compose up -d

# –ó—É–ø–∏–Ω–∏—Ç–∏
docker-compose down
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É

```
zoe_api/
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ routes.py          # API endpoints
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ schedule.py        # Pydantic –º–æ–¥–µ–ª—ñ
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ scraper.py         # –ü–∞—Ä—Å–∏–Ω–≥ ZOE —Å–∞–π—Ç—É
‚îÇ   ‚îî‚îÄ‚îÄ cache.py           # –ö–µ—à—É–≤–∞–Ω–Ω—è
‚îú‚îÄ‚îÄ cache/                 # –î–∏—Ä–µ–∫—Ç–æ—Ä—ñ—è –¥–ª—è –∫–µ—à—É
‚îú‚îÄ‚îÄ main.py               # –ì–æ–ª–æ–≤–Ω–∏–π —Ñ–∞–π–ª FastAPI
‚îú‚îÄ‚îÄ requirements.txt      # –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ Python
‚îú‚îÄ‚îÄ Dockerfile           # Docker image
‚îî‚îÄ‚îÄ docker-compose.yml   # Docker compose config
```

## API Endpoints

### –û—Å–Ω–æ–≤–Ω—ñ endpoints

| Method | Endpoint | –û–ø–∏—Å |
|--------|----------|------|
| GET | `/` | –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ API |
| GET | `/health` | –°—Ç–∞—Ç—É—Å –∑–¥–æ—Ä–æ–≤'—è API |
| GET | `/api/schedules/latest` | –û—Å—Ç–∞–Ω–Ω—ñ–π –∞–∫—Ç—É–∞–ª—å–Ω–∏–π –≥—Ä–∞—Ñ—ñ–∫ |
| GET | `/api/schedules/queue/{queue_id}` | –ì—Ä–∞—Ñ—ñ–∫ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—ó —á–µ—Ä–≥–∏ |
| GET | `/api/queues` | –°–ø–∏—Å–æ–∫ –≤—Å—ñ—Ö —á–µ—Ä–≥ |
| GET | `/api/cache/info` | –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∫–µ—à |
| DELETE | `/api/cache/clear` | –û—á–∏—Å—Ç–∏—Ç–∏ –∫–µ—à |

### –ü—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

#### –û—Ç—Ä–∏–º–∞—Ç–∏ –æ—Å—Ç–∞–Ω–Ω—ñ–π –≥—Ä–∞—Ñ—ñ–∫

```bash
curl http://localhost:8000/api/schedules/latest
```

**–í—ñ–¥–ø–æ–≤—ñ–¥—å:**
```json
{
  "success": true,
  "data": {
    "title": "25 –°–Ü–ß–ù–Ø –ü–û –ó–ê–ü–û–†–Ü–ó–¨–ö–Ü–ô –û–ë–õ–ê–°–¢–Ü –î–Ü–Ø–¢–ò–ú–£–¢–¨ –ì–ü–í",
    "queues": ["1.1", "1.2", "2.1", "2.2", "3.1", "3.2"],
    "times": [
      ["03:00", "08:00"],
      ["12:00", "17:00"],
      ["21:00", "24:00"]
    ]
  },
  "cache_hit": false,
  "updated_at": "2025-01-25T10:30:00Z"
}
```

#### –û—Ç—Ä–∏–º–∞—Ç–∏ –≥—Ä–∞—Ñ—ñ–∫ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—ó —á–µ—Ä–≥–∏

```bash
curl http://localhost:8000/api/schedules/queue/1.1
```

**–í—ñ–¥–ø–æ–≤—ñ–¥—å:**
```json
{
  "success": true,
  "queue_data": {
    "queue": "1.1",
    "outages": [
      {"start": "03:00", "end": "08:00"},
      {"start": "12:00", "end": "17:00"},
      {"start": "21:00", "end": "24:00"}
    ],
    "status": "active"
  },
  "cache_hit": false,
  "updated_at": "2025-01-25T10:30:00Z"
}
```

#### –û—Ç—Ä–∏–º–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ —á–µ—Ä–≥

```bash
curl http://localhost:8000/api/queues
```

**–í—ñ–¥–ø–æ–≤—ñ–¥—å:**
```json
{
  "success": true,
  "queues": ["1.1", "1.2", "2.1", "2.2", "3.1", "3.2", "4.1", "4.2", "5.1", "5.2", "6.1", "6.2"],
  "cache_hit": false
}
```

## –ß–µ—Ä–≥–∏

–î–æ—Å—Ç—É–ø–Ω—ñ —á–µ—Ä–≥–∏: **1.1, 1.2, 2.1, 2.2, 3.1, 3.2, 4.1, 4.2, 5.1, 5.2, 6.1, 6.2**

## –ö–µ—à—É–≤–∞–Ω–Ω—è

API –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∫–µ—à—É—î –¥–∞–Ω—ñ –Ω–∞ **30 —Ö–≤–∏–ª–∏–Ω** –¥–ª—è –∑–º–µ–Ω—à–µ–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ ZOE —Å–∞–π—Ç.

–©–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å–≤—ñ–∂—ñ –¥–∞–Ω—ñ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä `force_refresh`:

```bash
curl http://localhost:8000/api/schedules/latest?force_refresh=true
```

## iPhone –í—ñ–¥–∂–µ—Ç (Scriptable)

### ‚úÖ –ì–æ—Ç–æ–≤–∏–π –≤—ñ–¥–∂–µ—Ç –¥–ª—è iOS

–ü–æ–≤–Ω—ñ—Å—Ç—é —Ä–æ–±–æ—á–∏–π –≤—ñ–¥–∂–µ—Ç –¥–ª—è –¥–æ–¥–∞—Ç–∫—É [Scriptable](https://scriptable.app/):

üì± **–§–∞–π–ª**: [ZoeWidget.js](ZoeWidget.js)
üìñ **–Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è**: [SCRIPTABLE_WIDGET_GUIDE.md](SCRIPTABLE_WIDGET_GUIDE.md)

### –ú–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –≤—ñ–¥–∂–µ—Ç—É

- ‚ö°Ô∏è –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤–∞—à–æ–≥–æ –≥—Ä–∞—Ñ—ñ–∫—É –≤—ñ–¥–∫–ª—é—á–µ–Ω—å
- üí° –ü–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞—Ç—É—Å (—î/–Ω–µ–º–∞—î —Å–≤—ñ—Ç–ª–∞)
- ‚è∞ –ß–∞—Å –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –≤—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è/–≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è
- üìä 3 —Ä–æ–∑–º—ñ—Ä–∏: Small, Medium, Large
- üé® –ö—Ä–∞—Å–∏–≤–∏–π —Ç–µ–º–Ω–∏–π –¥–∏–∑–∞–π–Ω
- üíæ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∫–µ—à—É–≤–∞–Ω–Ω—è
- üîÑ Fallback –ø—Ä–∏ –≤—Ç—Ä–∞—Ç—ñ –∑'—î–¥–Ω–∞–Ω–Ω—è

### –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

1. –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å [Scriptable](https://apps.apple.com/ua/app/scriptable/id1405459188) –∑ App Store
2. –°–∫–æ–ø—ñ—é–π—Ç–µ –∫–æ–¥ –∑ [ZoeWidget.js](ZoeWidget.js)
3. –°—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤–∏–π —Å–∫—Ä–∏–ø—Ç —É Scriptable
4. –ù–∞–ª–∞—à—Ç—É–π—Ç–µ `API_BASE_URL` (–ø—ñ—Å–ª—è deployment)
5. –î–æ–¥–∞–π—Ç–µ –≤—ñ–¥–∂–µ—Ç –Ω–∞ –¥–æ–º–∞—à–Ω—ñ–π –µ–∫—Ä–∞–Ω
6. –£ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö –≤–∫–∞–∂—ñ—Ç—å —Å–≤–æ—é —á–µ—Ä–≥—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `1.1`)

**–î–µ—Ç–∞–ª—å–Ω–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è**: [SCRIPTABLE_WIDGET_GUIDE.md](SCRIPTABLE_WIDGET_GUIDE.md)

### API Endpoint –¥–ª—è –≤—ñ–¥–∂–µ—Ç—É

```
GET /api/schedules/queue/{queue_id}
```

–ü—Ä–∏–∫–ª–∞–¥ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ:
```json
{
  "success": true,
  "queue_data": {
    "queue": "1.1",
    "outages": [
      {"start": "03:00", "end": "08:00"},
      {"start": "12:00", "end": "17:00"}
    ],
    "status": "active"
  },
  "cache_hit": false,
  "updated_at": "2026-01-25T11:44:00"
}
```

## Deployment

### Heroku

```bash
# Login to Heroku
heroku login

# Create app
heroku create zoe-outage-api

# Deploy
git push heroku main

# Open
heroku open
```

### Railway

1. –ü—ñ–¥–∫–ª—é—á—ñ—Ç—å GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π
2. Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∑–Ω–∞—á–∏—Ç—å Python —Ç–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—å –¥–æ–¥–∞—Ç–æ–∫
3. API –±—É–¥–µ –¥–æ—Å—Ç—É–ø–Ω–∏–π –Ω–∞ –≤–∏–¥–∞–Ω–æ–º—É URL

### DigitalOcean App Platform

1. –°—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤–∏–π App
2. –ü—ñ–¥–∫–ª—é—á—ñ—Ç—å GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π
3. –í–∏–±–µ—Ä—ñ—Ç—å Python —è–∫ runtime
4. Deploy

## –î–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è

- [investigate_site.py](investigate_site.py) - –î–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ —Å–∞–π—Ç—É
- [check_wp_api.py](check_wp_api.py) - –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ WordPress REST API
- [parse_schedules.py](parse_schedules.py) - –ü–∞—Ä—Å–∏–Ω–≥ –≥—Ä–∞—Ñ—ñ–∫—ñ–≤ –≤—ñ–¥–∫–ª—é—á–µ–Ω—å
- [INVESTIGATION_SUMMARY.md](INVESTIGATION_SUMMARY.md) - –î–µ—Ç–∞–ª—å–Ω–∏–π –∑–≤—ñ—Ç –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è

## –†–æ–∑—Ä–æ–±–∫–∞

### –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º—ñ —Ä–æ–∑—Ä–æ–±–∫–∏

```bash
uvicorn main:app --reload
```

### –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è endpoints

```bash
# –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—é
# http://localhost:8000/docs
```

## –õ—ñ—Ü–µ–Ω–∑—ñ—è

MIT

## –ü—Ä–∏–º—ñ—Ç–∫–∏

‚ö†Ô∏è **–í–∞–∂–ª–∏–≤–æ**: –°–∞–π—Ç ZOE –Ω–µ –º–∞—î –æ—Ñ—ñ—Ü—ñ–π–Ω–æ–≥–æ API. –î–∞–Ω—ñ –æ—Ç—Ä–∏–º—É—é—Ç—å—Å—è —á–µ—Ä–µ–∑ –ø–∞—Ä—Å–∏–Ω–≥ HTML. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–∞–π—Ç—É –º–æ–∂–µ –∑–º—ñ–Ω—é–≤–∞—Ç–∏—Å—è.

‚úÖ **–ü–µ—Ä–µ–≤–∞–≥–∏**:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∫–µ—à—É–≤–∞–Ω–Ω—è
- REST API –∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—î—é
- –ì–æ—Ç–æ–≤–∏–π –¥–æ deployment
- –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ CORS –¥–ª—è –º–æ–±—ñ–ª—å–Ω–∏—Ö –¥–æ–¥–∞—Ç–∫—ñ–≤
