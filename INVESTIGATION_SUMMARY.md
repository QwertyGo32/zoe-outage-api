# Дослідження сайту ZOE.COM.UA - Графіки відключень

## Результати дослідження

### 1. Структура сайту
- **Платформа**: WordPress
- **URL**: https://www.zoe.com.ua/outage/
- **Тип контенту**: Архівні пости з графіками відключень

### 2. Доступні API

#### ❌ WordPress REST API
- REST API на сайті **обмежений/вимкнений**
- Стандартні endpoints не працюють:
  - `/wp-json/wp/v2/outage_schedules` - 404
  - `/wp-json/wp/v2/posts` - 404

#### ✅ Парсинг HTML
**Це єдиний доступний метод отримання даних!**

### 3. Структура даних графіків

Кожен графік містить:

```json
{
  "title": "25 СІЧНЯ ПО ЗАПОРІЗЬКІЙ ОБЛАСТІ ДІЯТИМУТЬ ГПВ",
  "date": "2025-01-25",
  "queues": ["1.1", "1.2", "2.1", "2.2", "3.1", "3.2", "4.1", "4.2", "5.1", "5.2", "6.1", "6.2"],
  "content_text": "Години відсутності електропостачання по чергам...",
  "times": [
    ["03:00", "08:00"],
    ["12:00", "17:00"],
    ["21:00", "24:00"]
  ]
}
```

### 4. Формат графіків

Типові черги: **1.1, 1.2, 2.1, 2.2, 3.1, 3.2, 4.1, 4.2, 5.1, 5.2, 6.1, 6.2**

Приклад запису:
```
1.1: 03:00 – 08:00, 12:00 – 17:00, 21:00 – 24:00
2.1: 00:00 – 03:30, 07:30 – 12:30, 16:30 – 21:30
```

## Рекомендації для створення віджету iPhone

### Архітектура рішення

```
┌─────────────────┐
│  iPhone Widget  │
│                 │
│  (WidgetKit)    │
└────────┬────────┘
         │
         │ HTTP Request
         ▼
┌─────────────────┐
│   Backend API   │
│   (Python)      │
│                 │
│  Flask/FastAPI  │
└────────┬────────┘
         │
         │ Web Scraping
         ▼
┌─────────────────┐
│  ZOE.COM.UA     │
│   /outage/      │
└─────────────────┘
```

### Кроки реалізації

#### Крок 1: Створити Backend API (Python)

**Технології:**
- FastAPI або Flask
- BeautifulSoup4 для парсингу
- Redis/SQLite для кешування (оновлення кожні 15-30 хвилин)

**Endpoints:**

1. `GET /api/schedules/latest` - останній актуальний графік
2. `GET /api/schedules/queue/{queue_id}` - графік для конкретної черги (наприклад, 1.1)
3. `GET /api/schedules/date/{date}` - графік на конкретну дату

**Приклад відповіді API:**
```json
{
  "date": "2025-01-25",
  "queue": "1.1",
  "outages": [
    {
      "start": "03:00",
      "end": "08:00"
    },
    {
      "start": "12:00",
      "end": "17:00"
    },
    {
      "start": "21:00",
      "end": "24:00"
    }
  ],
  "status": "active",
  "updated_at": "2025-01-24T20:30:00Z"
}
```

#### Крок 2: Створити iPhone Widget (Swift)

**Технології:**
- WidgetKit
- SwiftUI
- URLSession для API запитів

**Функціонал віджету:**
- Вибір черги користувачем (1.1, 1.2, тощо)
- Відображення поточного статусу (є світло / немає світла)
- Показ наступного відключення/увімкнення
- Візуальний індикатор часових проміжків на день

#### Крок 3: Хостинг Backend

**Варіанти:**
1. **Heroku** - простий deployment
2. **Railway** - сучасна альтернатива Heroku
3. **AWS Lambda** + API Gateway - serverless
4. **DigitalOcean App Platform** - простий і доступний

### Готові файли

1. ✅ [investigate_site.py](investigate_site.py) - дослідження сайту
2. ✅ [check_wp_api.py](check_wp_api.py) - перевірка WordPress API
3. ✅ [parse_schedules.py](parse_schedules.py) - парсинг графіків
4. ✅ [parsed_schedules.json](parsed_schedules.json) - приклад даних

## Наступні кроки

### 1. Створити Backend API
```bash
# Створити Flask/FastAPI додаток
# Додати парсер з parse_schedules.py
# Додати кешування
# Додати endpoints для віджету
```

### 2. Створити iOS додаток з віджетом
```bash
# Створити новий проект в Xcode
# Додати WidgetKit Extension
# Налаштувати API інтеграцію
# Реалізувати UI віджету
```

### 3. Deployment
```bash
# Задеплоїти Backend на хостинг
# Протестувати API
# Опублікувати iOS додаток в App Store
```

## Важливі зауваження

⚠️ **Проблеми і ризики:**

1. **Немає офіційного API** - доведеться парсити HTML
2. **Структура сайту може змінитися** - потрібно моніторити і оновлювати парсер
3. **Можливі блокування** - додати затримки між запитами, використовувати кешування
4. **SSL сертифікат** - є проблеми з сертифікатом сайту (потрібно `verify=False`)

✅ **Переваги:**

1. Дані публічні і доступні
2. Структура HTML відносно стабільна
3. Парсинг працює надійно
4. Можна кешувати дані на годину і більше

## Приклад використання парсера

```python
import requests
from bs4 import BeautifulSoup

# Отримати актуальний графік
response = requests.get('https://www.zoe.com.ua/outage/', verify=False)
soup = BeautifulSoup(response.text, 'html.parser')

# Парсинг (див. parse_schedules.py для повного коду)
# ...
```

## Контакти і підтримка

- Сайт: https://www.zoe.com.ua
- Телефон довідки: (можна додати з сайту)

---

**Статус**: ✅ Дослідження завершено
**Дата**: 2025-01-25
**Висновок**: Створення віджету можливе через Backend API з парсингом HTML
